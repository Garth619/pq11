window.GFToken=null,function(i){GFToken=function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this.form=i("#gform_"+this.formId),this.init=function(){var t=this;this.tokens={},this.isAjax||gformInitSpinner(this.formId),this.hasPages&&i(document).bind("gform_page_loaded",(function(i,e,s){e==t.formId&&s!=t.pageCount&&t.saveEntryData()})),this.form.submit((function(){t.onSubmit()}))},this.onSubmit=function(){this.form.data("gftokensubmitting")||(event.preventDefault(),this.form.data("gftokensubmitting",!0),this.saveEntryData(),this.processTokens())},this.processTokens=function(){for(var i in this.feeds){this.active_feed=this.feeds[i];var t={billing_fields:{},id:this.active_feed.id,name:this.active_feed.name};for(var e in this.active_feed.billing_fields)field_id=this.active_feed.billing_fields[e],t.billing_fields[e]=this.entry_data[field_id];window[this.callback].createToken(t,this)}},this.saveEntryData=function(){var t=this,e="input_"+this.formId+"_";this.entry_data||(this.entry_data={}),this.form.find('input[id^="'+e+'"], select[id^="'+e+'"], textarea[id^="'+e+'"]').each((function(){var s=i(this).attr("id").replace(e,"").replace("_",".");0<=i.inArray(s,t.fields)&&(t.entry_data[s]=i(this).val())}))},this.saveToken=function(t){this.tokens[this.active_feed.id]={feed_id:this.active_feed.id,response:t},this.tokens.length==this.feeds.length&&(this.form.find(this.responseField).val(i.toJSON(this.tokens)),this.form.submit())},this.init()}}(jQuery);